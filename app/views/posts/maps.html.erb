    <nav class="navbar bg-light">
      <a class="navbar-brand">Social News</a>
      <%= form_tag(posts_path, method: "get") do %>
        <%= text_field_tag(:keyword) %>
        <%= submit_tag("Cerca per argomento") %>
      <% end %>
          <% if current_user==nil %>
            <%= link_to "Clicca qui per fare il login", new_user_session_path() %>
          <% elsif can? :all, @user%>
            <%= button_to "Tutti gli utenti", users_path, method: "get"%>
          <% else %>
            <!--script google translate-->
            <div id="google_translate_element"></div>
            <script type="text/javascript">
              function googleTranslateElementInit() {
                new google.translate.TranslateElement({pageLanguage: 'it'}, 'google_translate_element');
              }
            </script>
            <%= link_to new_user_report_path(),  class: "btn mr-1" do %>
              <i class="fa-solid fa-gear fa-xl"></i> 
            <% end %>
            <%= link_to user_path(current_user.id), method: "get" , class: "btn" do%>
              <i class="fa fa-user fa-xl"></i> 
            <% end %>
          <% end %>
    </nav>

<div id="map"></div>


<script>
    var map;
    var pos = {lat: 47.3312903, lng:11.1680664};
    function initMap() {
        map = new google.maps.Map(document.getElementById("map"), {
            center: pos,
            zoom: 4,
        });

        var m = [
            getMarker(43.1754949, 13.0298647, 'Italia'),
            getMarker(46.6999999, 1.7153401, 'Francia'),
            getMarker(39.6489255, -3.3022213, 'Spagna'),
            getMarker(55.4207349, -2.7231131, 'Regno Unito'),
            getMarker(51.477977, 11.0692267, 'Germania')
        ];

        function getMarker(lat, lng, title){
            var marker = new google.maps.Marker({
            position : {lat: lat, lng: lng},
            map: map,
            title: title
            });

            marker.addListener('click', function() {
              var title = marker.get('title');
              // Esegui la chiamata AJAX al server per recuperare i post
              $.ajax({
                url: '/maps/' + title,
                type: 'GET',
                success: function(response) {
                  console.log(response);
                  $("#markerModalLabel").text(title);
                  $('#markerModal').modal('show');
                  var postsHtml = '';
                  response.forEach(function(post) {
                    postsHtml += '<div class="post">';
                    postsHtml += '<h4 class="post-author">' + post.author_name + '</h4>';
                    postsHtml += '<h3 class="post-title">' + post.title + '</h3>';
                    postsHtml += '<p class="post-body">' + post.body + '...<a href = "' + post.url + '" target="_blank" rel="noopener noreferrer">Articolo completo</a></p>';
                    postsHtml += '<img class="post-img" src=' + post.img_test + ' style="width: 20%; border-radius: 5px;" >';
                    postsHtml += '</div>';
                  });
                  $('#markerModal .modal-body').html(postsHtml);
                },

                error: function() {
                  alert('Errore durante il caricamento dei post.');
                }
              });
            });

        }
    }

</script>

<style>

#map {
  height: 500px;
}

/* 
 * Optional: Makes the sample page fill the window. 
 */
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
}

</style>


<!-- Modal -->
<div class="modal fade" id="markerModal" tabindex="-1" role="dialog" aria-labelledby="markerModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content" style="width:600px;">
      <div class="modal-header">
        <h5 class="modal-title" id="markerModalLabel">Titolo del marker</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Chiudi</button>
      </div>
    </div>
  </div>
</div>
